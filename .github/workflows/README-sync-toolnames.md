# Sync Tool Names Workflow

This workflow automatically syncs tool names from the `microsoft/vscode-copilot-chat` repository to keep our `src/toolNames.json` file up-to-date.

## Overview

The workflow:
1. Checks out both the current repository and `microsoft/vscode-copilot-chat`
2. Uses the GitHub Copilot CLI to scan for tool identifiers in the upstream repository
3. Compares found tools with existing mappings in `src/toolNames.json`
4. Generates friendly names for any missing tools
5. Updates `src/toolNames.json` if new tools are found
6. Creates a pull request with the changes

## Schedule

The workflow runs:
- **Automatically**: Every Monday at 2:30 PM UTC
- **On changes**: When the workflow file or prompt file is modified
- **Manually**: Can be triggered via the Actions tab in GitHub

## Authentication

The workflow uses the GitHub CLI (`gh copilot`) which requires authentication:
- **Primary**: Uses `COPILOT_CLI_TOKEN` secret if available (recommended for Copilot CLI access)
- **Fallback**: Uses `GITHUB_TOKEN` (built-in GitHub Actions token)

### Setting up COPILOT_CLI_TOKEN (Optional)

If you want to use a personal access token for the Copilot CLI:

1. Create a Personal Access Token (PAT) with appropriate permissions
2. Add it as a repository secret named `COPILOT_CLI_TOKEN`
3. The workflow will automatically use it

If not configured, the workflow will attempt to use `GITHUB_TOKEN`.

## Prompt

The prompt used by the Copilot CLI is stored in:
`.github/workflows/prompts/sync-toolnames-prompt.md`

This prompt instructs the Copilot CLI to:
- Scan `src/extension/tools/common/toolNames.ts` in the vscode-copilot-chat repository
- Extract tool IDs from `ToolName` and `ContributedToolName` enums
- Compare with existing `src/toolNames.json` entries
- Output missing entries in a format that can be pasted directly into the JSON file

## Output

When new tools are found:
- A branch named `sync-toolnames` is created or updated
- Changes are committed to `src/toolNames.json` only
- A pull request is created (or updated if one already exists)
- Labels: `maintenance`, `autogenerated`

When no changes are needed:
- The workflow completes successfully
- No branches or PRs are created
- A summary message indicates the file is up-to-date

## Files Modified

This workflow only modifies:
- `src/toolNames.json` (adds new tool name mappings)

All other files remain unchanged.

## Manual Execution

To run the workflow manually:

1. Go to the "Actions" tab in GitHub
2. Select "Sync Tool Names from vscode-copilot-chat"
3. Click "Run workflow"
4. Select the branch (usually `main`)
5. Click "Run workflow"

## Troubleshooting

### Copilot CLI Not Found

If the workflow fails with "Copilot CLI not found":
- Ensure the GitHub CLI (`gh`) is available in the runner
- The workflow should automatically download the Copilot CLI if needed

### Authentication Errors

If you see authentication errors:
- Verify that `COPILOT_CLI_TOKEN` secret is set (if using)
- Check that the token has appropriate permissions
- Try using the `GITHUB_TOKEN` fallback

### Invalid JSON Output

If the workflow generates invalid JSON:
- Review the Copilot CLI output in the workflow logs
- The parsing step validates JSON before committing
- Invalid JSON will cause the workflow to fail safely

## Related Files

- **Workflow**: `.github/workflows/sync-toolnames.yml`
- **Prompt**: `.github/workflows/prompts/sync-toolnames-prompt.md`
- **Target File**: `src/toolNames.json`
- **Upstream Source**: `microsoft/vscode-copilot-chat/src/extension/tools/common/toolNames.ts`
